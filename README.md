# Web Time Tracker

## 简介

Web Time Tracker 是一款浏览器扩展，用于统计并可视化您在不同网站上的浏览时长，帮助您更好地了解和管理自己的在线时间。

## 功能特性

### 📊 时间统计
- 自动跟踪您在各个网站上的浏览时长
- 按域名和子域名层级展示统计数据
- 支持查看总浏览时长和各网站的相对比例
- 可视化进度条展示网站使用占比

### 🔄 数据管理
- 本地存储浏览数据，保护隐私
- 支持用户登录/注册，实现多设备数据同步
- 自动同步机制（每5分钟），确保数据最新
- 支持手动同步和数据清空

### 🎨 用户界面
- 简洁直观的弹出式统计面板
- 支持按域名展开查看详细子域名数据
- 支持删除特定域名的统计数据
- 登录/注册/密码重置功能
- 介绍/帮助页面
- 设置

##

实际效果展示

![项目图片1](https://browser-extension.cn-nb1.rains3.com/pic/1.png)

## 安装方法

1. 克隆或下载本仓库
2. 打开浏览器的扩展管理页面
3. 启用"开发者模式"
4. 点击"加载已解压的扩展程序"
5. 选择 `extension` 文件夹

## 文件结构

```
extension/
├── background.js      # 后台服务脚本，核心时间跟踪逻辑
├── popup.html         # 弹出页面HTML结构
├── popup.js           # 弹出页面交互逻辑
├── manifest.json      # 扩展配置文件
├── intro.html         # 介绍/帮助页面
├── icon16.png         # 16x16图标
├── icon32.png         # 32x32图标
├── icon48.png         # 48x48图标
└── icon128.png        # 128x128图标
```

## 核心功能实现

### 时间跟踪机制

1. **活动检测**：
   - 监听标签页激活事件 (`tabs.onActivated`)
   - 监听标签页URL变化事件 (`tabs.onUpdated`)
   - 监听窗口焦点变化事件 (`windows.onFocusChanged`)

2. **时间计算**：
   - 记录当前活动标签页的开始时间
   - 切换标签页或窗口时，计算并保存之前页面的浏览时长
   - 使用串行执行机制确保时间计算的准确性
   - 每1分钟自动保存一次当前浏览时间

3. **数据存储**：
   - 使用 `chrome.storage.session` 存储临时跟踪状态
   - 使用 `chrome.storage.local` 存储持久化的浏览时长数据
   - 按域名组织存储，支持子域名细分

### 数据同步机制

1. **增量同步**：
   - 计算本地数据与上次同步数据的差值
   - 仅上传新增的浏览时长数据
   - 上传成功后更新同步快照

2. **同步策略**：
   - 每5分钟自动触发一次同步
   - 支持手动触发同步
   - 扩展启动时自动同步一次

3. **服务器交互**：
   - 使用Bearer Token进行身份验证
   - 支持数据上传和下载
   - 处理网络异常情况

## 技术栈

- **Chrome Extension API** (Manifest V3)
- **JavaScript** (ES6+)
- **HTML5** + **CSS3**
- **Chrome Storage API** (本地和会话存储)
- **Chrome Tabs API** (标签页管理)
- **Chrome WebNavigation API** (导航事件)
- **Chrome Alarms API** (定时任务)
- **Chrome Favicon API** (网站图标获取)

## 权限说明

| 权限 | 用途 |
|------|------|
| `tabs` | 访问和管理浏览器标签页 |
| `storage` | 存储浏览数据和用户信息 |
| `webNavigation` | 监听网页导航事件 |
| `alarms` | 设置定时任务（自动保存和同步） |
| `favicon` | 获取网站图标 |

## 使用指南

1. **查看统计数据**：
   - 点击浏览器工具栏中的扩展图标
   - 在弹出面板中查看各网站的浏览时长
   - 点击域名可展开查看子域名详情

2. **管理数据**：
   - 点击"刷新"按钮重新加载统计数据
   - 点击"同步"按钮手动同步数据到服务器
   - 点击"清空数据"按钮删除所有本地统计数据
   - 鼠标悬停在域名上，点击删除按钮可删除特定域名数据

3. **用户管理**：
   - 点击"登录/注册"按钮进入认证界面
   - 支持注册新账号、登录现有账号和重置密码
   - 登录后可实现数据同步

4. **获取帮助**：
   - 点击"介绍/帮助"按钮查看扩展的详细介绍和使用说明
   - 点击"设置"按钮进入设置界面，可配置是否统计IP地址和本地文件

## 数据安全

- 浏览数据默认仅存储在本地浏览器中
- 用户数据（如登录凭证）使用浏览器安全存储
- 数据同步采用HTTPS加密传输
- 支持随时删除本地数据

## 开发与贡献

### 开发环境

1. 安装浏览器（Chrome/Edge等支持Manifest V3的浏览器）
2. 启用开发者模式
3. 加载已解压的扩展程序

### 代码规范

- 使用ES6+语法
- 遵循Chrome扩展开发最佳实践
- 保持代码简洁和注释清晰

### 测试

- 手动测试各项功能
- 测试不同场景下的时间统计准确性
- 测试数据同步功能

## 版本历史

- **v1.2**：
  - 新增设置界面
  - 可配置是否统计IP地址和本地文件
  - 优化数据展示方式

- **v1.1**：
  - 优化时间统计算法
  - 改进数据同步机制
  - 修复已知bug
  - 提升用户界面体验

- **v1.0**：
  - 初始版本
  - 基本的时间统计功能
  - 用户登录和数据同步
  - 可视化展示

## 联系方式

如有问题或建议，欢迎通过以下方式联系：

- QQ群：738988912

- 项目地址：[Web Time Tracker](https://yutangxiaowu.cn/step/browser-extension/Web_Time_Tracker/intro.html)

## 许可证

本项目采用MIT许可证，详见LICENSE文件。
